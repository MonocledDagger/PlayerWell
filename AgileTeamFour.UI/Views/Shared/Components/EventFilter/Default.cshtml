@model List<AgileTeamFour.UI.ViewModels.EventDetailsVM>

<div id="search-filters" class="mb-3">
    <h3>Filter Events</h3>
    <div class="form-group">
        <label>
            <input type="checkbox" id="filter-by-game" onclick="toggleDropdown('game-dropdown')" />
            Game Name
        </label>
        <select id="game-dropdown" class="form-control d-none" name="gameName">
            <option value="">-- Select Game --</option>
            <!-- This is an example of what will populate dynamically -->
            <option value="Game1">Game1</option>
            <option value="Game2">Game2</option>
        </select>
    </div>

    <div class="form-group">
        <label>
            <input type="checkbox" id="filter-by-author" onclick="toggleDropdown('author-dropdown')" />
            Author Name
        </label>
        <select id="author-dropdown" class="form-control d-none" name="authorName">
            <option value="">-- Select Author --</option>
            <!-- This is an example of what will populate dynamically -->
            <option value="Author1">Author1</option>
            <option value="Author2">Author2</option>
        </select>
    </div>

    <div class="form-group">
        <label>
            <input type="checkbox" id="filter-by-date" onclick="toggleDropdown('date-dropdowns')" />
            Event Date
        </label>
        <div id="date-dropdowns" class="d-none">
            <label for="start-date">After</label>
            <input type="date" id="start-date" name="startDate" class="form-control mb-2" />
            <label for="end-date">Before</label>
            <input type="date" id="end-date" name="endDate" class="form-control" />
        </div>
    </div>

    <!-- This is the end of the shell of the filter form for the events-->
    <button type="button" class="btn btn-primary mt-2" onclick="applyFilters()">Search</button>
</div>

<script>
    function toggleDropdown(dropdownId) {
        const dropdown = document.getElementById(dropdownId);
        dropdown.classList.toggle("d-none");
    }

    function applyFilters() {
        const filters = {
            gameName: document.getElementById('game-dropdown').value,
            authorName: document.getElementById('author-dropdown').value,
            startDate: document.getElementById('start-date').value,
            endDate: document.getElementById('end-date').value
        };

        // Redirect to the controller with the selected filters as query parameters
        const query = Object.entries(filters)
            .filter(([key, value]) => value) // Exclude empty filters
            .map(([key, value]) => `${encodeURIComponent(key)}=${encodeURIComponent(value)}`)
            .join('&');

        window.location.href = `/Event/Index?${query}`;
    }
</script>